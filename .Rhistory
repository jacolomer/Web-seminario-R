Mod2a <- lmer(welfatt ~ educationG + SEXG + AGEG + meritocracy + subclass + (1|V5), data = data)
tab_model(Mod0a, Mod1a, Mod2a, show.se = TRUE, show.r2 = TRUE, show.loglik = TRUE, show.aic = TRUE, show.dev = TRUE, string.se = "SE")
Mod0b <- lmer(conflict ~ (1|V5), data = data)
Mod1b <- lmer(conflict  ~ educationG + SEXG + AGEG + meritocracy + permob + (1|V5), data = data)
Mod2b <- lmer(conflict ~ educationG + SEXG + AGEG + meritocracy + permob + subclass + (1|V5), data = data)
tab_model(Mod0b, Mod1b, Mod2b, show.se = TRUE, show.r2 = TRUE, show.loglik = TRUE, show.aic = TRUE, show.dev = TRUE, string.se = "SE")
Mod0c <- lmer(idealsociety ~ (1|V5), data = data)
Mod0c <- glmer(idealsociety ~ (1|V5), data = data)
?glmer
table(data$subclass, data$idealsociety)
sepsi <- sqrt(1-((0.438*0.438) + (0.231*0.231) + (2*0.200*0.432*0.231))) #para calcular sigma epsilon#
powerMediation.Sobel(n = 252, theta.1a = -0.20, lambda.a = -0.438, sigma.x = 0.5007, sigma.m = 0.73447, sigma.epsilon = 0.8455) ##0.5367
library(pacman)
p_load(foreign, haven, dplyr, labelled, readr, JSmediation, mediation, tidyr, tibble, tidyverse, psych, powerMediation, MBESS)
powerMediation.Sobel(n = 252, theta.1a = -0.20, lambda.a = -0.438, sigma.x = 0.5007, sigma.m = 0.73447, sigma.epsilon = 0.8455) ##0.5367
sepsi2 <- sqrt(1-((-0.480*-0.480) + (0.378*0.378) + (2*-0.480*-0.413*0.378))) #para calcular sigma epsilon#
powerMediation.Sobel(n = 266, theta.1a = -0.480, lambda.a = -0.413, sigma.x = 0.5008151, sigma.m = 0.7580199, sigma.epsilon = sepsi2) ##0.99##
rm(list=ls())
library(pacman)
p_load(ggplot2, labelled, dplyr, psych, lme4, reghelper, haven, sjPlot, MASS, arm, stargazer, performance, interplot, reshape2, merTools, sjmisc, install = TRUE)
data <- read_sav("C:/Users/User/Desktop/Tesis/Estudios/Estudio clase obrera y actitudes políticas/ISSP2009.sav")
val_labels(data) <- NULL
data <- data %>%
mutate(V9r = (6-V9),
V10r = (6 - V10),
justpay = na_if(V21, 6),
ineq = (6 - V32),
welf1 = (6-V33),
welf2 = (6-V34),
welf3 = V35,
confl1 = (5-V40),
confl2 = (5-V41),
confl3 = (5-V42),
confl4 = (5-V43),
permob = (V45 - V44),
actsociety = to_factor(V54),
idealsociety = to_factor(V55),
subclass = relevel(to_factor(V66), "2"),
education = DEGREE
)
data$meritocracy <- rowMeans(cbind(data$V9r, data$V10r),na.rm=TRUE)
corr.test(data$V9r, data$V10r) #.43
data$welfatt <- rowMeans(cbind(data$welf1, data$welf2, data$welf3),na.rm=TRUE)
data %>%
dplyr::select(welf1, welf2, welf3) %>%
item_intercor() #.22
data %>%
dplyr::select(welf1, welf2, welf3) %>%
tab_corr() # ¿Quitar el tres?
data$conflict <- rowMeans(cbind(data$confl1, data$confl2, data$confl3, data$confl4),na.rm=TRUE)
data %>%
dplyr::select(confl1, confl2, confl3, confl4) %>%
psych::alpha() #.83
data <- data %>%
dplyr::group_by(V5) %>%
dplyr::mutate(meritocracyC = mean(meritocracy, na.rm = TRUE),
educationC = mean(education, na.rm = TRUE),
SEXC = mean(SEX, na.rm = TRUE),
AGEC = mean(AGE, na.rm = TRUE),
) %>%
dplyr::ungroup() %>%
dplyr::mutate(
meritocracyG = (meritocracy - meritocracyC),
educationG = (education - educationC),
SEXG = (SEX - SEXC),
AGEG = (AGE - AGEC)
)
frq(data$SEX)
frq(data$subclass)
p_load(ggplot2, labelled, dplyr, psych, lme4, reghelper, haven, sjPlot, MASS, arm, stargazer, performance, interplot, reshape2, merTools, sjmisc, lavaan, install = TRUE)
welfcfa <- '
level: 1
welfcfa =~ welf1 + welf2 + welf3
level: 2
welfcfa =~ welf1 + welf2 + welf3
'
welffit <- cfa(model = welfcfa, data = data, cluster = "country")
welffit <- cfa(model = welfcfa, data = data, cluster = "V5")
summary(welffit, fit.measures = TRUE)
welf2cfa <- '
level: 1
welfcfa =~ welf1 + welf2
level: 2
welfcfa =~ welf1 + welf2
'
welf2fit <- cfa(model = welf2cfa, data = data, cluster = "V5")
summary(welffit, fit.measures = TRUE)
conflcfa <- '
level: 1
conflcfa =~ confl1 + confl2 + confl3 + confl4
level: 2
conflcfa =~ confl1 + confl2 + confl3 + confl4
'
conflfit <- cfa(model = conflcfa, data = data, cluster = "V5")
summary(welf2fit, fit.measures = TRUE)
summary(conflfit, fit.measures = TRUE)
descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, ineq, conflict, welfatt) %>%
sjmisc::descr(out = "viewer")
descriptiveslvl1
data <- sjlabelled::remove_all_labels(data)
descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, ineq, conflict, welfatt) %>%
sjmisc::descr(out = "viewer")
descriptiveslvl1
setwd("C:/Users/User/Desktop/Tesis/Estudios/Estudio clase obrera y actitudes políticas")
descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, ineq, conflict, welfatt) %>%
sjmisc::descr(out = "viewer", file = "descriptives lvl1.doc")
descriptiveslvl1
correlationslvl1 <- descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, ineq, conflict, welfatt) %>%
sjmisc::tab_corr(file = "correlations lvl1.doc")
correlationslvl1 <- descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, ineq, conflict, welfatt) %>%
sjPlot::tab_corr(file = "correlations lvl1.doc")
correlationslvl1
data <- data %>%
mutate(V9r = (6-V9),
V10r = (6 - V10),
justpay = na_if(V21, 6),
ineq = (6 - V32),
welf1 = (6-V33),
welf2 = (6-V34),
welf3 = V35,
confl1 = (5-V40),
confl2 = (5-V41),
confl3 = (5-V42),
confl4 = (5-V43),
permob = (V44 - V45),
actsociety = to_factor(V54),
idealsociety = to_factor(V55),
subclass = relevel(to_factor(V66), "2"),
education = DEGREE
)
data <- sjlabelled::remove_all_labels(data)
descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, ineq, conflict, welfatt) %>%
sjmisc::descr(file = "descriptives lvl1.doc")
descriptiveslvl1
correlationslvl1 <- descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, ineq, conflict, welfatt) %>%
sjPlot::tab_corr(file = "correlations lvl1.doc")
correlationslvl1
descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, ineq, conflict, welfatt) %>%
sjmisc::descr(file = "descriptives lvl1.doc")
descriptiveslvl1
correlationslvl1 <- descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, ineq, conflict, welfatt) %>%
sjPlot::tab_corr(file = "correlations lvl1.doc")
correlationslvl1
descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, ineq, conflict, welfatt) %>%
sjmisc::descr(file = "descriptives lvl1.doc")
descriptiveslvl1
descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, ineq, conflict, welfatt) %>%
sjmisc::descr(out = "viewer", file = "descriptives lvl1.doc")
descriptiveslvl1
data <- data %>%
dplyr::group_by(V5) %>%
dplyr::mutate(meritocracyC = mean(meritocracy, na.rm = TRUE),
educationC = mean(education, na.rm = TRUE),
SEXC = mean(SEX, na.rm = TRUE),
AGEC = mean(AGE, na.rm = TRUE),
justpayC = mean(justpay, na.rm = TRUE),
) %>%
dplyr::ungroup() %>%
dplyr::mutate(
meritocracyG = (meritocracy - meritocracyC),
educationG = (education - educationC),
SEXG = (SEX - SEXC),
AGEG = (AGE - AGEC),
justpayG = (justpay - justpayC)
)
Mod0 <- lmer(ineq ~ (1|V5), data = data)
Mod1 <- lmer(ineq ~ educationG + SEXG + AGEG + meritocracy + permob + justpay + (1|V5), data = data)
Mod2 <- lmer(ineq ~ educationG + SEXG + AGEG + meritocracy + permob + justpay + subclass + (1|V5), data = data)
tab_model(Mod0, Mod1, Mod2, show.se = TRUE, show.r2 = TRUE, show.loglik = TRUE, show.aic = TRUE, show.dev = TRUE, string.se = "SE", file = "Model1.doc")
Mod0a <- lmer(welfatt ~ (1|V5), data = data)
Mod1a <- lmer(welfatt  ~ educationG + SEXG + AGEG + meritocracy + permob + justpay + (1|V5), data = data)
Mod2a <- lmer(welfatt ~ educationG + SEXG + AGEG + meritocracy + permob + justpay + subclass + (1|V5), data = data)
tab_model(Mod0a, Mod1a, Mod2a, show.se = TRUE, show.r2 = TRUE, show.loglik = TRUE, show.aic = TRUE, show.dev = TRUE, string.se = "SE", file = "Models2.doc")
Mod0b <- lmer(conflict ~ (1|V5), data = data)
Mod1b <- lmer(conflict  ~ educationG + SEXG + AGEG + meritocracy + permob + justpay + (1|V5), data = data)
Mod2b <- lmer(conflict ~ educationG + SEXG + AGEG + meritocracy + permob + justpay + subclass + (1|V5), data = data)
tab_model(Mod0b, Mod1b, Mod2b, show.se = TRUE, show.r2 = TRUE, show.loglik = TRUE, show.aic = TRUE, show.dev = TRUE, string.se = "SE", file = "Models3.doc")
frq(data$SEX)
frq(data$subclass)
setwd("C:/Users/User/Desktop/Tesis/Estudios/Artículo 1 (Estudios 1 y 2)/Nuevo artículo 2")
data1 <- read_sav("C:/Users/User/Desktop/Tesis/Estudios/Estudio 1 - SCM y políticas de protección social en función de pobreza a raíz de la crisis o crónica/Datos/Study 1.sav")
library(pacman)
p_load(plyr, ggplot2, labelled, dplyr, psych, reghelper, haven, sjPlot,  performance, interplot, sjmisc, parameters, effectsize, interactions, qqplotr, install = TRUE)
data1 <- read_sav("C:/Users/User/Desktop/Tesis/Estudios/Estudio 1 - SCM y políticas de protección social en función de pobreza a raíz de la crisis o crónica/Datos/Study 1.sav")
View(data1)
class(data1$Condicion)
class(data1$IDTOT)
class(data1$WARMTHTOTAL)
class(data1$COMPETENCETOTAL)
data1$Condicion2 <- to_factor(data1$Condicion)
mod1 <- lm(WARMTHTOTAL ~ Condicion2*IDTOT, data = data1)
summary(mod1)
plot(mod1)
mod2 <- lm(COMPETENCETOTAL ~ Condicion2*IDTOT, data = data1)
summary(mod2)
mod3 <- lm(APSTOTAL ~ Condicion2*IDTOT, data = data1)
summary(mod3)
summary(mod1)
ci(mod1)
summary(mod2)
ci(mod2)
summary(mod3)
reghelper::simple_slopes(mod1)
reghelper::simple_slopes(mod2)
reghelper::simple_slopes(mod3)
interactions::sim_slopes(model = mod2, pred = "Condicion2", modx = "IDTOT", digits = 3)
??build_contrast
data1$Condicion2 <- to_factor(data1$Condicion, "0", "1")
data1$contrast <- JSmediation::build_contrast(data1$Condicion2, "0", "1")
mod1 <- lm(WARMTHTOTAL ~ contrats*IDTOT, data = data1)
mod1 <- lm(WARMTHTOTAL ~ contrast*IDTOT, data = data1)
summary(mod1)
mod3 <- lm(APSTOTAL ~ contrast*IDTOT, data = data1)
summary(mod3)
reghelper::simple_slopes(mod3)
interactions::sim_slopes(model = mod2, pred = "Condicion2", modx = "IDTOT", digits = 3)
interactions::sim_slopes(model = mod2, pred = "contrast", modx = "IDTOT", digits = 3)
interactions::sim_slopes(model = mod3, pred = "contrast", modx = "IDTOT", digits = 3)
interact_plot(model = mod3, pred = "contrast", modx = "IDTOT",
interval = TRUE,
plot.points = TRUE) +
theme_bw()
data2 <- read_sav("C:/Users/User/Desktop/Tesis/Estudios/Estudio 2 - Políticas de protección social y criterios de merecimiento/Datos/Data_after_exclusions_study_2.sav"
)
data2$Condicion2 <- to_factor(data2$Condicion)
data2$contrast <- JSmediation::build_contrast(data2$Condicion2, "0", "1")
View(data2)
mod1a <- lm(MERT ~ contrast*IDTOT, data = data2)
mod1a <- lm(MERT ~ contrast*IDPT, data = data2)
summary(mod1a)
reghelper::simple_slopes(mod1a)
interactions::sim_slopes(model = mod1a, pred = "contrast", modx = "IDPT", digits = 3)
a <- interactions::sim_slopes(model = mod1a, pred = "contrast", modx = "IDPT", digits = 3)
ci(a)
mod2a <- lm(APPS ~ contrast*IDPT, data = data2)
summary(mod2a)
interactions::sim_slopes(model = mod2a, pred = "contrast", modx = "IDPT", digits = 3)
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", facet.modx = TRUE)
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", facet.modx = FALSE)
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5)
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, x.label = "Deservigness scores")
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores")
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 3)
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 2)
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 1.5)
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 1.5, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"))
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 1.5, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), modx.labels = "Total identification Scores")
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 1.5, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score")
p1 <- interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 1.5, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score")
p1 + theme_bw()
p1 + theme_classic()
?xlim
p1 + theme_classic() + xlim(c(0, 5))
p1 + theme_classic() + ylim(c(0, 5))
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 1.5, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score", colors = "black")
p1 + theme_classic() + ylim(c(1, 5))
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 1.5, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score", colors = c("black", "black")
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 1.5, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score", colors = c("black", "black"))
interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 1.5, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score", colors = c("black", "black"))
p1 + theme_classic() + ylim(c(1, 5))
p1 <- interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 1.5, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score", colors = c("black", "black"))
p1 + theme_classic() + ylim(c(1, 5))
p2 <- p1 + theme_classic() + ylim(c(1, 5))
jpeg(file="Moderation1",width=2000,height=1400, units = "px", res = 300)
p2
dev.off()
p1 <- interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservigness scores", x.label = "Condition", line.thickness = 1.15, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score", colors = c("black", "black"))
p2 <- p1 + theme_classic() + ylim(c(1, 5))
jpeg(file="Moderation1",width=2000,height=1400, units = "px", res = 300)
p2
dev.off()
p1 <- interact_plot(model = mod1a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Deservingness scores", x.label = "Condition", line.thickness = 1.15, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score", colors = c("black", "black"))
p2 <- p1 + theme_classic() + ylim(c(1, 5))
jpeg(file="Moderation1",width=2000,height=1400, units = "px", res = 300)
p2
dev.off()
p3 <- interact_plot(model = mod2a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Attitudes toward social protection", x.label = "Condition", line.thickness = 1.15, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score", colors = c("black", "black"))
p4 <- p1 + theme_classic() + ylim(c(1, 5))
jpeg(file="Moderation2",width=2000,height=1400, units = "px", res = 300)
p4 <- p1 + theme_classic() + ylim(c(1, 5))
jpeg(file="Moderation2",width=2000,height=1400, units = "px", res = 300)
p4
dev.off()
dev.off()
jpeg(file="Moderation2",width=2000,height=1400, units = "px", res = 300)
p4
dev.off()
p4
jpeg(file="Moderation2",width=2000,height=1400, units = "px", res = 300)
p4
dev.off()
p4 <- p3 + theme_classic() + ylim(c(1, 5))
library(pacman)
p_load(plyr, ggplot2, labelled, dplyr, psych, reghelper, haven, sjPlot,  performance, interplot, sjmisc, parameters, effectsize, interactions, qqplotr, install = TRUE)
p3 <- interact_plot(model = mod2a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Attitudes toward social protection", x.label = "Condition", line.thickness = 1.15, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score", colors = c("black", "black"))
p4 <- p3 + theme_classic() + ylim(c(1, 5))
jpeg(file="Moderation2",width=2000,height=1400, units = "px", res = 300)
p4
dev.off()
p4 <- p3 + theme_classic() + ylim(c(1, 5)) + cex_lab(1.5)
?cex_lab
p3 <- interact_plot(model = mod2a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Attitudes toward social protection", x.label = "Condition", line.thickness = 1.15, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score", colors = c("black", "black"), cex.lab = 2)
p3
p3 <- interact_plot(model = mod2a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Attitudes toward social protection", x.label = "Condition", line.thickness = 1.15, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score", colors = c("black", "black"), cex.lab = 4)
p3
p4 <- p3 + theme_classic() + ylim(c(1, 5)) + cex_lab(1.5)
p4
jpeg(file="Moderation2",width=2000,height=1400, units = "px", res = 300)
p4
dev.off()
p4 <- p3 + theme_classic() + ylim(c(1, 5))
p4
p3 <- interact_plot(model = mod2a, pred = "contrast", modx = "IDPT", interval = TRUE, int.type = "confidence", int.width = 0.5, y.label = "Attitudes toward social protection", x.label = "Condition", line.thickness = 1.15, pred.labels = c("Persistent poverty", "Poverty due to economic crisis"), legend.main = "Total identification score", colors = c("black", "black"), cex.lab = 4)
p4 <- p3 + theme_classic() + ylim(c(1, 5))
p4
frq(data1$Condicion
)
frq(data2$Condicion
)
frq(data2$Sexo
)
mean(data2$Edad)
descr(data2$Edad)
frq(data2$Sexo
)
rm(list=ls())
setwd("C:/Users/User/Desktop/Tesis/Estudios/Estudio clase obrera y actitudes políticas")
library(pacman)
p_load(ggplot2, labelled, dplyr, psych, lme4, reghelper, haven, sjPlot, MASS, arm, stargazer, performance, interplot, reshape2, merTools, sjmisc, lavaan, install = TRUE)
data <- read_sav("C:/Users/User/Desktop/Tesis/Estudios/Estudio clase obrera y actitudes políticas/ISSP2009.sav")
View(data)
data$meritocracy <- rowMeans(cbind(data$V9r, data$V10r, data$V6),na.rm=TRUE)
val_labels(data) <- NULL
data <- data %>%
mutate(V9r = (6-V9),
V10r = (6 - V10),
justpay = na_if(V21, 6),
ineq = (6 - V32),
welf1 = (6-V33),
welf2 = (6-V34),
welf3 = V35,
confl1 = (5-V40),
confl2 = (5-V41),
confl3 = (5-V42),
confl4 = (5-V43),
permob = (V44 - V45),
actsociety = to_factor(V54),
idealsociety = to_factor(V55),
subclass = relevel(to_factor(V66), "2"),
education = DEGREE
)
data$meritocracy <- rowMeans(cbind(data$V9r, data$V10r, data$V6),na.rm=TRUE)
data %>%
dplyr::select(v9r, v10r, v6) %>%
psych::alpha() #.22
data %>%
dplyr::select(V9r, V10r, V6) %>%
psych::alpha() #.22
data %>%
dplyr::select(V6, V7, V8, V9r, V10r, V11, V12, V13, V14, V15, V16) %>%
sjPlot::tab_corr() #.22
data %>%
dplyr::select(V6, V7, V8, V9, V10, V11, V12, V13, V14, V15, V16) %>%
sjPlot::tab_corr() #.22
data %>%
dplyr::select(V6, V7, V11, V12) %>%
psych::alpha() #.22
data$meritocracy2 <- rowMeans(cbind(data$V6, data$V7, data$V11, data$V12),na.rm=TRUE)
data$welfatt <- rowMeans(cbind(data$welf1, data$welf2, data$welf3),na.rm=TRUE)
data$conflict <- rowMeans(cbind(data$confl1, data$confl2, data$confl3, data$confl4),na.rm=TRUE)
descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, meritocracy2, ineq, conflict, welfatt) %>%
sjmisc::descr(out = "viewer")
descriptiveslvl1
correlationslvl1 <- descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, meritocracy2, ineq, conflict, welfatt) %>%
sjPlot::tab_corr(out = "viewer")
data <- sjlabelled::remove_all_labels(data)
correlationslvl1 <- descriptiveslvl1 <- data %>%
dplyr::select(AGE, education, justpay, permob, meritocracy, meritocracy2, ineq, conflict, welfatt) %>%
sjPlot::tab_corr()
correlationslvl1
data <- data %>%
dplyr::group_by(V5) %>%
dplyr::mutate(meritocracyC = mean(meritocracy, na.rm = TRUE),
meritocracy2C = mean(meritocracy2, na.rm = TRUE),
educationC = mean(education, na.rm = TRUE),
SEXC = mean(SEX, na.rm = TRUE),
AGEC = mean(AGE, na.rm = TRUE),
justpayC = mean(justpay, na.rm = TRUE),
) %>%
dplyr::ungroup() %>%
dplyr::mutate(
meritocracyG = (meritocracy - meritocracyC),
meritocracy2G = (meritocracy2 - meritocracy2C),
educationG = (education - educationC),
SEXG = (SEX - SEXC),
AGEG = (AGE - AGEC),
justpayG = (justpay - justpayC)
)
Mod0 <- lmer(ineq ~ (1|V5), data = data)
Mod1 <- lmer(ineq ~ educationG + SEXG + AGEG + meritocracy2 + permob + justpay + (1|V5), data = data)
Mod2 <- lmer(ineq ~ educationG + SEXG + AGEG + meritocracy2 + permob + justpay + subclass + (1|V5), data = data)
tab_model(Mod0, Mod1, Mod2, show.se = TRUE, show.r2 = TRUE, show.loglik = TRUE, show.aic = TRUE, show.dev = TRUE, string.se = "SE")
Mod0a <- lmer(welfatt ~ (1|V5), data = data)
Mod1a <- lmer(welfatt  ~ educationG + SEXG + AGEG + meritocracy2 + permob + justpay + (1|V5), data = data)
Mod2a <- lmer(welfatt ~ educationG + SEXG + AGEG + meritocracy2 + permob + justpay + subclass + (1|V5), data = data)
tab_model(Mod0a, Mod1a, Mod2a, show.se = TRUE, show.r2 = TRUE, show.loglik = TRUE, show.aic = TRUE, show.dev = TRUE, string.se = "SE")
Mod0b <- lmer(conflict ~ (1|V5), data = data)
Mod1b <- lmer(conflict  ~ educationG + SEXG + AGEG + meritocracy2 + permob + justpay + (1|V5), data = data)
Mod2b <- lmer(conflict ~ educationG + SEXG + AGEG + meritocracy2 + permob + justpay + subclass + (1|V5), data = data)
tab_model(Mod0b, Mod1b, Mod2b, show.se = TRUE, show.r2 = TRUE, show.loglik = TRUE, show.aic = TRUE, show.dev = TRUE, string.se = "SE")
data <- data %>%
mutate(V9r = (6-V9),
V10r = (6 - V10),
V7r = (6-V7),
V8r = (6 - V8),
V11r = (6-V11),
V12r = (6 - V12),
justpay = na_if(V21, 6),
ineq = (6 - V32),
welf1 = (6-V33),
welf2 = (6-V34),
welf3 = V35,
confl1 = (5-V40),
confl2 = (5-V41),
confl3 = (5-V42),
confl4 = (5-V43),
permob = (V44 - V45),
actsociety = to_factor(V54),
idealsociety = to_factor(V55),
subclass = relevel(to_factor(V66), "2"),
education = DEGREE
)
data$meritocracy <- rowMeans(cbind(data$V9r, data$V10r, data$V6),na.rm=TRUE)
data$meritocracy2 <- rowMeans(cbind(data$V6, data$V7, data$V11, data$V12),na.rm=TRUE)
data %>%
dplyr::select(V6r, V7r, V11r, V12r) %>%
psych::alpha() #.71
data <- data %>%
mutate(V9r = (6-V9),
V10r = (6 - V10),
V6r = (6-V6),
V7r = (6 - V7),
V11r = (6-V11),
V12r = (6 - V12),
justpay = na_if(V21, 6),
ineq = (6 - V32),
welf1 = (6-V33),
welf2 = (6-V34),
welf3 = V35,
confl1 = (5-V40),
confl2 = (5-V41),
confl3 = (5-V42),
confl4 = (5-V43),
permob = (V44 - V45),
actsociety = to_factor(V54),
idealsociety = to_factor(V55),
subclass = relevel(to_factor(V66), "2"),
education = DEGREE
)
data$meritocracy2 <- rowMeans(cbind(data$V6r, data$V7r, data$V11r, data$V12r),na.rm=TRUE)
data %>%
dplyr::select(V6r, V7r, V11r, V12r) %>%
psych::alpha() #.71
data$welfatt <- rowMeans(cbind(data$welf1, data$welf2, data$welf3),na.rm=TRUE)
data$conflict <- rowMeans(cbind(data$confl1, data$confl2, data$confl3, data$confl4),na.rm=TRUE)
data <- data %>%
dplyr::group_by(V5) %>%
dplyr::mutate(meritocracyC = mean(meritocracy, na.rm = TRUE),
meritocracy2C = mean(meritocracy2, na.rm = TRUE),
educationC = mean(education, na.rm = TRUE),
SEXC = mean(SEX, na.rm = TRUE),
AGEC = mean(AGE, na.rm = TRUE),
justpayC = mean(justpay, na.rm = TRUE),
) %>%
dplyr::ungroup() %>%
dplyr::mutate(
meritocracyG = (meritocracy - meritocracyC),
meritocracy2G = (meritocracy2 - meritocracy2C),
educationG = (education - educationC),
SEXG = (SEX - SEXC),
AGEG = (AGE - AGEC),
justpayG = (justpay - justpayC)
)
Mod0 <- lmer(ineq ~ (1|V5), data = data)
Mod1 <- lmer(ineq ~ educationG + SEXG + AGEG + meritocracy2 + permob + justpay + (1|V5), data = data)
Mod2 <- lmer(ineq ~ educationG + SEXG + AGEG + meritocracy2 + permob + justpay + subclass + (1|V5), data = data)
tab_model(Mod0, Mod1, Mod2, show.se = TRUE, show.r2 = TRUE, show.loglik = TRUE, show.aic = TRUE, show.dev = TRUE, string.se = "SE")
Mod0a <- lmer(welfatt ~ (1|V5), data = data)
Mod1a <- lmer(welfatt  ~ educationG + SEXG + AGEG + meritocracy2 + permob + justpay + (1|V5), data = data)
Mod2a <- lmer(welfatt ~ educationG + SEXG + AGEG + meritocracy2 + permob + justpay + subclass + (1|V5), data = data)
tab_model(Mod0a, Mod1a, Mod2a, show.se = TRUE, show.r2 = TRUE, show.loglik = TRUE, show.aic = TRUE, show.dev = TRUE, string.se = "SE")
meritcfa <- '
level: 1
meritcfa =~ V6 + V7 + V11 + V12
level: 2
meritcfa =~ V6 + V7 + V11 + V12
'
meritfit <- cfa(model = meritcfa, data = data, cluster = "V5")
summary(meritfit, fit.measures = TRUE)
